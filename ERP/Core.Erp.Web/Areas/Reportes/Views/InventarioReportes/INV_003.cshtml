
@model Core.Erp.Info.Helps.cl_filtros_Info
@{
    Layout = "~/Areas/Reportes/Views/Layout/_Layout_filtros.cshtml";
    ViewBag.Title = "INV_003";
    if (Session["IdUsuario"] == null || Session["IdEmpresa"] == null)
    {
        Response.Redirect("~/Account/Login");
    }
}
@using (Html.BeginForm("INV_003", "InventarioReportes", FormMethod.Post, new { @class = "form", @role = "form" }))
{
    <div class="box collapsed-box">
        <div class="box-header with-border">
            <div class="row">
                <div class="col-md-12">
                    <button type="submit" class="btn btn-primary">Aplicar filtros</button>
                </div>
            </div>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
                    <i class="fa fa-plus"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
                    <i class="fa fa-times"></i>
                </button>
            </div>
        </div>
        <div class="box-body">
            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="IdSucursal">Sucursal</label>
                            @Html.DropDownListFor(q => q.IdSucursal, new SelectList(ViewBag.lst_sucursal, "IdSucursal", "Su_Descripcion"), new { @class = "form-control", @id = "IdSucursal" })
                            @Html.ValidationMessageFor(q => q.IdSucursal, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="IdBodega">Bodega</label>
                            @Html.DropDownListFor(q => q.IdBodega, new SelectList(ViewBag.lst_bodega, "IdBodega", "bo_Descripcion"), new { @class = "form-control", @id = "IdBodega" })
                            @Html.ValidationMessageFor(q => q.IdBodega, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="IdCategoria">Categoría</label>
                            @Html.DropDownListFor(q => q.IdCategoria, new SelectList(ViewBag.lst_categoria, "IdCategoria", "ca_Categoria"), new { @class = "form-control", @id = "IdCategoria" })
                            @Html.ValidationMessageFor(q => q.IdCategoria, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="IdLinea">Línea</label>
                            @Html.DropDownListFor(q => q.IdLinea, new SelectList(ViewBag.lst_linea, "IdLinea", "nom_linea"), new { @class = "form-control", @id = "IdLinea" })
                            @Html.ValidationMessageFor(q => q.IdLinea, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="dGrupo">Grupo</label>
                            @Html.DropDownListFor(q => q.IdGrupo, new SelectList(ViewBag.lst_grupo, "IdGrupo", "nom_grupo"), new { @class = "form-control", @id = "dGrupo" })
                            @Html.ValidationMessageFor(q => q.IdGrupo, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="IdSubGrupo">Subgrupo</label>
                            @Html.DropDownListFor(q => q.IdSubGrupo, new SelectList(ViewBag.lst_subgrupo, "IdSubgrupo", "nom_subgrupo"), new { @class = "form-control", @id = "IdSubGrupo" })
                            @Html.ValidationMessageFor(q => q.IdSubGrupo, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
            </div><div class="row">
    <div class="col-md-12">
        <div class="col-md-2">
            <div class="form-group">
                <label for="">Fecha inicio*</label>
                <div class="input-group date">
                    <div class="input-group-addon">
                        <i class="fa fa-calendar"></i>
                    </div>
                    @Html.TextBoxFor(q => q.fecha_ini, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "fecha_ini" })
                    @Html.ValidationMessageFor(q => q.fecha_ini, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-group">
                <label for="">Fecha fin*</label>
                <div class="input-group date">
                    <div class="input-group-addon">
                        <i class="fa fa-calendar"></i>
                    </div>
                    @Html.TextBoxFor(q => q.fecha_fin, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "fecha_fin" })
                    @Html.ValidationMessageFor(q => q.fecha_fin, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
    </div>
</div>
            <!-- /.box-body -->
        </div>
    </div>


    <div class="box">
        <div class="box-header with-border">
            <h3 class="box-title">@ViewBag.Title</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
                    <i class="fa fa-minus"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
                    <i class="fa fa-times"></i>
                </button>
            </div>
        </div>
        <div class="box-body">
            @Html.DevExpress().WebDocumentViewer(settings =>
            {
            settings.MobileMode = false;
            settings.Name = "webDocumentViewer";
            }).Bind(ViewBag.Report).GetHtml()
        </div>
        <!-- /.box-body -->
        <div class="box-footer">
            [@Session["IdEmpresa"]] @Session["nom_empresa"]
        </div>
        <!-- /.box-footer-->
    </div>    
}
<script>
    $(function () {
        //Date picker
        $('#fecha_ini').datepicker({
            autoclose: true
        })

        $('#fecha_fin').datepicker({
            autoclose: true
        })

        });
    $("#IdSucursal").change(function () {
        cargar_bodega();
    });
    $("#IdCategoria").change(function () {
        cargar_lineas();
        cargar_grupos();
        cargar_subgrupos();
    });
    function cargar_bodega() {
        var sucursal = $("#IdSucursal").val();

        var datos = {
            IdSucursal: sucursal
        }

        $.ajax({
            type: 'POST',
            data: JSON.stringify(datos),
            url: '@Url.Action("cargar_bodega", "InventarioReportes",new { Area = "Reporte" })',
            async: false,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                $("#IdBodega").val(data.IdBodega);
            },
            error: function (error) {
            }
        });
    }
    function cargar_lineas() {
        var categoria = $("#IdCategoria").val();

        var datos = {
            IdCategoria: categoria
        }

        $.ajax({
            type: 'POST',
            data: JSON.stringify(datos),
            url: '@Url.Action("cargar_lineas", "InventarioReportes",new { Area = "Reporte" })',
            async: false,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                $("#IdLinea").val(data.IdLinea);
            },
            error: function (error) {
            }
        });
    }
    function cargar_grupos() {
        var linea = $("#IdLinea").val();

        var datos = {
            IdLinea: linea
        }

        $.ajax({
            type: 'POST',
            data: JSON.stringify(datos),
            url: '@Url.Action("cargar_grupos", "InventarioReportes",new { Area = "Reporte" })',
            async: false,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                $("#IdGrupo").val(data.IdGrupo);
            },
            error: function (error) {
            }
        });
    }
    function cargar_subgrupos() {
        var grupo = $("#IdGrupo").val();

        var datos = {
            IdGrupo: grupo
        }

        $.ajax({
            type: 'POST',
            data: JSON.stringify(datos),
            url: '@Url.Action("cargar_subgrupos", "InventarioReportes",new { Area = "Reporte" })',
            async: false,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                $("#IdSuGrupo").val(data.IdSubGrupo);
            },
            error: function (error) {
            }
        });
    }
</script>